@using HN120_ShopQuanAo.Data.Models;
@model HN120_ShopQuanAo.View.Areas.Admin.Models.CreateUserAccountViewModel
@{
    ViewData["Title"] = "CreateUserAccount";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
}
<style>
    .header h2 {
        margin: 0;
    }

    .btn-new-address {
        background-color: #ff4500;
        color: white;
        padding: 10px 20px;
        text-decoration: none;
        border: none;
        cursor: pointer;
        font-size: 16px;
    }

    .address-list {
        list-style: none;
        padding: 0;
    }

    .address-item {
        border-bottom: 1px solid #ddd;
        padding: 15px 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .address-item:last-child {
        border-bottom: none;
    }

    .address-details {
        flex-grow: 1;
    }

    .address-actions {
        display: flex;
        gap: 10px;
    }

    .default-tag {
        color: red;
        font-weight: bold;
        margin-left: 10px;
    }

    .btn-update, .btn-delete, .btn-set-default {
        background-color: white;
        border: 1px solid #ddd;
        padding: 5px 10px;
        cursor: pointer;
    }

    .btn-update:hover, .btn-delete:hover, .btn-set-default:hover {
        background-color: #f0f0f0;
    }
</style>
@if (TempData["ErrorMessage"] != null)
{
    <script>
        console.log("ErrorMessage: @TempData["ErrorMessage"]");
        document.addEventListener("DOMContentLoaded", function () {
            console.log("Document loaded");
            Swal.fire({
                icon: "error",
                title: "Oops...",
                text: "@TempData["ErrorMessage"]",
            });
        });
    </script>
}
<!-- Các phần còn lại của View vẫn giữ nguyên -->
<form asp-action="CreateUserAccount" method="post" enctype="multipart/form-data">
    <div class="container-xl px-4 mt-4">
        <div class="row">
            <!-- Avatar Upload Area -->
            <div class="col-xl-2">
                <div class="card mb-4 mb-xl-0">
                    <div class="card-header">Ảnh đại diện</div>
                    <div class="card-body text-center">
                        <img class="img-account-profile rounded-circle mb-2" src="~/img/Avatar/AvatarDefault.png" alt="avatar" style="width: 100px; height:100px; object-fit: cover">
                        <input asp-for="NewAccount.Avatar" class="form-control" type="file" name="imageFile" class="btn btn-primary" accept="image/*">
                    </div>
                </div>
            </div>

            <!-- Personal Information Area -->
            <div class="col-xl-5">
                <div class="card mb-4">
                    <div class="card-header">Thông tin cá nhân</div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="small mb-1">Họ tên</label>
                            <input asp-for="@Model.NewAccount.FullName" name="NewAccount.FullName" class="form-control" type="text" placeholder="Enter your full name">
                        </div>
                        <div class="mb-3">
                            <label class="small mb-1">Địa chỉ Email</label>
                            <input asp-for="@Model.NewAccount.Email" name="NewAccount.Email" class="form-control" type="email" placeholder="Enter your email address">
                        </div>

                        <div class="row gx-3 mb-3">
                            <div class="col-md-6">
                                <label class="small mb-1">Số điện thoại</label>
                                <input asp-for="@Model.NewAccount.PhoneNumber" name="NewAccount.PhoneNumber" class="form-control" type="tel" placeholder="Enter your phone number">
                            </div>
                            <div class="col-md-6">
                                <label class="small mb-1">Ngày sinh</label>
                                <input asp-for="@Model.NewAccount.Birthday" name="NewAccount.Birthday" class="form-control" type="date">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="small mb-1">Mật khẩu</label>
                            <input asp-for="@Model.NewAccount.Password" name="NewAccount.Password" class="form-control" type="password" placeholder="Enter your password">
                        </div>
                        <div class="mb-3">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" asp-for="@Model.NewAccount.Gender" name="NewAccount.Gender" value="1">
                                <label class="form-check-label">Nam</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" asp-for="@Model.NewAccount.Gender" name="NewAccount.Gender" value="2">
                                <label class="form-check-label">Nữ</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" asp-for="@Model.NewAccount.Gender" name="NewAccount.Gender" value="3">
                                <label class="form-check-label">Khác</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Delivery Address Area -->
            <div class="col-xl-5">
                <div class="card mb-4">
                    <div class="card-header">Địa chỉ nhận hàng</div>
                    <div class="card-body">
                        <div class="form-group">
                            <label>Họ và tên</label>
                            <input type="text" class="form-control" asp-for="DeliveryAddress.Consignee" required>
                            <span asp-validation-for="DeliveryAddress.Consignee" class="text-danger"></span>
                        </div>
                        <div class="form-group">
                            <label>Số điện thoại</label>
                            <input type="text" class="form-control" asp-for="DeliveryAddress.PhoneNumber" required>
                            <span asp-validation-for="DeliveryAddress.PhoneNumber" class="text-danger"></span>
                        </div>
                        <div class="form-group">
                            <label>Tỉnh/Thành phố</label>
                            <select class="form-control" asp-for="DeliveryAddress.City" id="city" required>
                                <option value="" selected>Chọn tỉnh thành</option>
                            </select>
                            <span asp-validation-for="DeliveryAddress.City" class="text-danger"></span>
                        </div>
                        <div class="form-group">
                            <label>Quận/Huyện</label>
                            <select class="form-control" asp-for="DeliveryAddress.District" id="district" required>
                                <option value="" selected>Chọn quận huyện</option>
                            </select>
                            <span asp-validation-for="DeliveryAddress.District" class="text-danger"></span>
                        </div>
                        <div class="form-group">
                            <label>Phường/Xã</label>
                            <select class="form-control" asp-for="DeliveryAddress.Ward" id="ward" required>
                                <option value="" selected>Chọn phường xã</option>
                            </select>
                            <span asp-validation-for="DeliveryAddress.Ward" class="text-danger"></span>
                        </div>
                        <div class="form-group">
                            <label>Địa chỉ cụ thể</label>
                            <input type="text" class="form-control" asp-for="DeliveryAddress.Street" required>
                            <span asp-validation-for="DeliveryAddress.Street" class="text-danger"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-group">
            <input type="submit" value="Add" class="btn btn-primary" />
        </div>
    </div>
</form>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script>
    $(document).ready(function () {
        $('input[type="file"]').change(function (e) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('.img-account-profile').attr('src', e.target.result);
            }
            reader.readAsDataURL(e.target.files[0]);
        });
    });

    var citis = document.getElementById("city");
    var districts = document.getElementById("district");
    var wards = document.getElementById("ward");

    axios.get("https://raw.githubusercontent.com/kenzouno1/DiaGioiHanhChinhVN/master/data.json")
        .then(function (response) {
            renderCity(response.data);
        })
        .catch(function (error) {
            console.error("Error fetching data:", error);
        });

    function renderCity(data) {
        for (const x of data) {
            citis.options[citis.options.length] = new Option(x.Name, x.Name);
        }
        citis.onchange = function () {
            districts.length = 1;
            wards.length = 1;
            if (this.value != "") {
                const result = data.filter(n => n.Name === this.value);

                for (const k of result[0].Districts) {
                    districts.options[districts.options.length] = new Option(k.Name, k.Name);
                }
            }
        };
        districts.onchange = function () {
            wards.length = 1;
            const dataCity = data.filter((n) => n.Name === citis.value);

            if (this.value != "") {
                const dataWards = dataCity[0].Districts.filter(n => n.Name === this.value)[0].Wards;

                for (const w of dataWards) {
                    wards.options[wards.options.length] = new Option(w.Name, w.Name);
                }
            };
        };
    }
</script>
