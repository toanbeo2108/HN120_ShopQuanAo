@using HN120_ShopQuanAo.Data.Models
@using HN120_ShopQuanAo.View.Areas.Admin.Data
@model IEnumerable<HN120_ShopQuanAo.View.Areas.Admin.Data.ChiTietSPView>

    @{
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
    IEnumerable<Voucher> lstvc = ViewBag.lstVC as IEnumerable<Voucher>;
    IEnumerable<ThanhToan_ThanhToanHistory> thanhtoanhoadon = ViewBag.thanhtoanhoadon as IEnumerable<ThanhToan_ThanhToanHistory>;
   
    }
    <style>
    #chitiethoadon_table th:nth-child(1),
    #chitiethoadon_table td:nth-child(1) {
        display: none;
    }
    </style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" integrity="sha512-b2QcS5SsA8tZodcDtGRELiGv5SaKSk1vDHDaQRda0htPYWZ6046lr3kJ5bAAQdpV2mmA/4v0wQF9MyU6/pDIAg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.min.js" integrity="sha512-WW8/jxkELe2CAiE4LvQfwm1rajOS8PHasCCx+knHG0gBHt8EXxS6T6tJRTGuDQVnluuAvMxWF4j8SNFDKceLFg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
<script src="~/js/Hoadon/getdiachi.js"></script>
<script src="~/js/HoaDon.js"></script>
<div class="row justify-content-center">
    <div class="card">
        <div class="card-header">
           <h2>Hóa đơn</h2>
           <div class="col-md-12">
                        <input id="btn_ma" style="display:none" class="form-control" type="text" />
                    </div>
           <div class="row">
              <div class="col-md-5">
                  <div class="row">
                      <div class="col-md-6" style="display:none">
                          <label for="btn_UserID">User Name</label>
                          <input id="btn_UserID" class="form-control" type="text"value="991d42f4-70e9-4f27-9dcc-33645f486764" />
                      </div>
                      <div class="col-md-6">
                          <label for="btn_MaVoucher">Mã Voucher</label>
                          <select id="btn_MaVoucher" class="form-select">
                              <option value="">Chọn Voucher</option>
                              @foreach (var item in lstvc)
                              {
                                    <option value="@item.MaVoucher" data-giatrigiam="@item.GiaTriGiam">@item.MaVoucher (giảm @item.GiaTriGiam )"</option>
                              }
                          </select>
                      </div>
                      <div class="col-md-6">
                          <label for="btn_NgayTaoDon">Ngày tạo hóa đơn</label>
                          <input id="btn_NgayTaoDon" class="form-control" type="date" />
                      </div>
                      <div class="col-md-6" style="display:none">
                          <label for="btn_TongGiaTriHangHoa">Tổng tiền</label>
                          <input id="btn_TongGiaTriHangHoa" class="form-control" type="text" />
                      </div>
                      <div class="col-md-6" style="display:none">
                          <label for="btn_Status">Trạng thái</label>
                          <input id="btn_Status" class="form-control" type="text" value="5" />
                      </div>
                      <div class="col-md-6">
                          <label for="btn_PhuongTTT">Phương thức thanh toán</label>
                          <select id="btn_PhuongTTT" class="form-select">
                              @foreach (var item in thanhtoanhoadon)
                              {
                                  <option value="@item.MaPhuongThuc">@item.TenPhuongThuc</option>
                              }

                          </select>
                      </div>
                  </div>
              </div>

              <div class="col-md-7">
                 <div class="row">
                      <div class="col-md-4">
                          <label for="btn_TenKhachHang">Tên khách hàng</label>
                          <input id="btn_TenKhachHang" class="form-control" type="text" />
                      </div>
                      <div class="col-md-4">
                          <label for="btn_SoDienThoai">Số điện thoại</label>
                          <input id="btn_SoDienThoai" class="form-control" type="text" />
                      </div>
                      <div class="col-md-4">
                          <label for="btn_TinhThanh">Tỉnh thành</label>
                          <select id="btn_TinhThanh" class="form-control">
                              <option value="">Chọn Tỉnh/Thành</option>
                          </select>
                          <div id="tinhThanhLoader" class="spinner-border text-primary" role="status"style="display:none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                      </div>
                      <div class="col-md-4">
                          <label for="btn_QuanHuyen">Quận/Huyện</label>
                          <select id="btn_QuanHuyen" class="form-control" disabled>
                              <option value="">Chọn Quận/Huyện</option>
                          </select>
                          <div id="quanHuyenLoader" class="spinner-border text-primary" role="status"style="display:none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                      </div>
                      <div class="col-md-4">
                          <label for="btn_XaPhuong">Xã/Phường</label>
                          <select id="btn_XaPhuong" class="form-control" disabled>
                              <option value="">Chọn Xã/Phường</option>
                          </select>
                          <div id="xaPhuongLoader" class="spinner-border text-primary" role="status"style="display:none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                      </div>
                      <div class="col-md-4">
                          <label for="btn_PhiShip">Phí ship (VNĐ)</label>
                          <input id="btn_PhiShip" class="form-control" type="number" min="0" placeholder="Nhập phí vậnchuyển" />
                      </div>
                 </div>
              </div>
          
           </div>
        </div>
    <div class="card-body">
               <div class="row">
                   <div class="col-md-7">
                       <h2>Danh sách sản phẩm</h2>
                       <div class="col-md-12">
                          <div class="row mb-3">
                              <div class="col-md-4">
                                  <input type="text" id="search-input" class="form-control" onkeyup="filterFunction()"placeholder="Tìm kiếm...">
                              </div>
                              <div class="col-md-4">
                                  <select id="select-color" class="form-select" aria-label="Default select example"onchange="filterFunction()">
                                      <option selected>Chọn màu</option>
                                      @foreach (var item in Model.Select(x => x.TenMau).Distinct())
                                      {
                                          <option value="@item">@item</option>
                                      }
                                  </select>
                              </div>
                              <div class="col-md-4">
                                  <select id="select-size" class="form-select" aria-label="Default selectexample"onchange="filterFunction()">
                                      <option selected>Chọn size</option>
                                      @foreach (var item in Model.Select(x => x.TenSize).Distinct())
                                      {
                                          <option value="@item">@item</option>
                                      }
                                  </select>
                              </div>
                          </div>
                       <div class="col-md-12">
                            @if (Model.Any())
                            {
                                <div style="height: 630px; overflow-y: auto;">
                                        <table class="table table-bordered" id="sanpham_table">
                                            <thead>
                                                <tr>
                                                    <th>STT</th>
                                                    <th>Ảnh</th>
                                                    <th>SKU</th>
                                                    <th>Mã Sp</th>
                                                    <th>Tên SP</th>
                                                    <th>Size</th>
                                                    <th>Màu</th>
                                                
                                                    <th>Giá bán</th>
                                                    <th>Số lượng hiện có</th>
                                                    <th>Hành động</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @{
                                                    int i = 1;

                                                }
                                                @foreach (var item in Model)
                                                {

                                                    <tr>
                                                        <td>@i</td>
                                                        <td>@item.UrlAnhSpct</td>
                                                        <td>@item.SKU</td>
                                                        <td>@item.MaSp</td>
                                                        <td>@item.TenSP</td>
                                                        <td>@item.TenSize</td>
                                                        <td>@item.TenMau</td>
                                                   
                                                        <td>@item.GiaBan</td>
                                                        <td>@item.SoLuongTon</td>

                                                        <td>
                                                            <button type="button"  class="btn btn-danger" id="btn_chonsp"
                                                                    data-SKU="@item.SKU"
                                                                    data-GiaBan="@item.GiaBan"
                                                                    data-TenSP="@item.TenSP"
                                                                    data-MaSize="@item.MaSize"
                                                                    data-MaMau="@item.MaMau"
                                                                data-SoLuongTon ="@item.SoLuongTon">
                                                                Chọn
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    i++;
                                                }
                                            </tbody>

                                        </table>
                                </div>
                                
                            }
                            else
                            {
                                <p>Không có dữ liệu.</p>
                            }
                        </div>
                   </div>
                    </div>
                   <div class="col-md-5">
                        <div class="row" style="height: 60%;background-color:aliceblue">
                            <div class="col-md-12">
                                <div class="col-md-12">
                                    @* <input id="btn_maHDCT" style="display:none" class="form-control" value="@ViewBag.lstHDCT" type="text" /> *@
                                </div>
                                <h2> Chi tiết hóa đơn</h2>
                                <div style="max-height: 350px; overflow-y: auto;">
                                    <table class="table table-bordered" id="chitiethoadon_table">
                                        <thead>
                                            <tr>
                                                <th style="display:none">SKU</th>
                                                <th>Tên sản phẩm</th>
                                                <th>Size</th>
                                                <th>Màu</th>
                                                <th style="width:120px">Số lượng mua</th>
                                                <th>Đơn giá</th>
                                                <th>Hành dộng</th>

                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                            </tr>
                                        </tbody>

                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row" style="height: 40%; overflow-y: auto;background-color:beige;">
                            <div class="co-md-12"><h2>Chi tiết thanh toán</h2></div>
                            <table class="info-table">
                                <tr>
                                    <th style="width:180px"><h3>Tổng số tiền:</h3></th>
                                    <td><input id="btn_tongtien" style="font-size:xx-large;color:brown" class="form-control" type="text"></td>
                                    <td><h3>VNĐ</h3></td>
                                </tr>
                               @*  <tr>
                                    <th><h3>Thuế VAT:</h3></th>
                                    <td><input id="btn_thue" style="font-size:xx-large;color:brown" class="form-control" type="text"></td>
                                    <td><h3>VNĐ</h3></td>
                                </tr> *@
                            </table>
                            <div class="col-md-12" style="display: flex; justify-content: center; align-items: center;">
                                <button type="button" class="btn btn-danger" id="btn_thanhtoanhoadon" style="width: 100%; height: 70px;">
                                    <h4 style="margin: 0;">Thanh toán</h4>
                                </button>
                            </div>
                         </div>
                    </div>
               </div>
            </div>
    </div> 
</div>




